<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="google-site-verification" content="MygUF14plGsEYaQfIeStl3p00BaOQcrjbz-31zEYAzM" />
    
    <link rel="stylesheet" href="../reset.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style.css" type="text/css">
    <link rel="stylesheet" href="payments.css" type="text/css">
    <script src="../script.js" defer></script>
    <link rel="shortcut icon" href="../files/images/favicon.png" type="image/png">

    <title>Grandpa Mining | Crunchyroll</title>
</head>
<body>
    <div class="header">
        <img class="GMLogo" src="../files/images/2019 logo transparent.png" alt="GPM Logo">
        <h1 class="GMLogoText">Granpa Mining</h1>

        <img id="navIcon" src="../files/images/mobileMenu.png" alt="Navigation Menu" style="display: none;">
    
            <div class="navElements">
                <p><a href="../index.html">Home</a></p>
                <div class="navDiv"></div>
                <p><a href="../Projects/Projects.html"> Projects </a></p>
            </div>
    </div>
    <div class="body2">

        <div class="payment">
            <h2 class="title">Payment Status</h2>
            <h2 class="month">Currently shown month: <span class="monthTAG">January</span></h2>

            <div class="payment-container">
                <ul>
                    <li>Dalura <span class="price">1,25€</span> <br> <span class="status">Payed</span></li>
                    <li>Frozer13 <span class="price">2,50€</span> <br> <span class="statusNP">Not Payed</span></li>
                    <li>iGoof <span class="price">1,25€</span> <br> <span class="status">Payed</span></li>
                    <li>Milu28 <span class="price">1,25€</span> <br> <span class="statusPP">Pre-payed</span> <br> <div id="PPmonthsContainer"><span class="PPmonths">January</span><span class="PPmonths">February</span></div></li>
                </ul>
            </div>
        </div>
        <div id="weekT" class="week-table">
            <h2 class="title">Simulcasts on our database</h2>
            
            <h3 class="date">Loading...</h3>
            <div class="week-table-container">
                <ul>
                    <li>Loading...</li>
                </ul>
            </div>
        </div>
    </div>
    
<!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>

<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-analytics.js"></script>

<!-- Add Firebase products that you want to use -->
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-database.js"></script>

<script>
// TODO: Replace the following with your app's Firebase project configuration
var firebaseConfig = {
    apiKey: "AIzaSyAhPz-IG85lj7AIPvrPvxV0-RnLNaU888A",
    authDomain: "project-id.firebaseapp.com",
    databaseURL: "https://grandpa-mining-website.firebaseio.com/",
    projectId: "project-id",
    storageBucket: "project-id.appspot.com",
    messagingSenderId: "sender-id",
    appId: "app-id",
    measurementId: "G-measurement-id",
};
  
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

retrieveData()
function retrieveData() {
    firebase.database().ref('/anime/').once('value').then(function(snapshot){
        let animeArray = snapshot.val()
        console.log(animeArray)
        
        let loadingElement = document.getElementById('weekT')
        while (loadingElement.firstChild){
            loadingElement.removeChild(loadingElement.firstChild)
        }
        
        let i = 0
        animeArray.forEach(element => {
            const listElement = document.createElement('div')
            const listDescContainer = document.createElement('ul')
            const listDiv = document.createElement('div')
            const listDate = document.createElement('h3')
            
            listDate.innerText = element.day 
            element.anime.forEach(element => {
                if (element.title === 'No anime scheduled for this day'){
                    let listDesc = document.createElement('li')
                    listDesc.innerText = element.title

                    listDescContainer.appendChild(listDesc)
                } else {
                    const listDesc = document.createElement('li')
                    listDesc.innerText = element.title
                    
                    const newLine = document.createElement('br')
    
                    const listTime = document.createElement('h6')
                    listTime.innerText=element.time
                    listTime.setAttribute('class', 'time')
                    
                    const listPlatform = document.createElement('h6')
                    listPlatform.innerText=element.platform
                    listPlatform.setAttribute('class', 'platform')
    
                    listDesc.appendChild(document.createElement('br'))
                    listDesc.appendChild(listTime)
                    listDesc.appendChild(listPlatform)
                    listDescContainer.appendChild(listDesc)
                }
            })
            listDiv.appendChild(listDescContainer)
            listElement.append(listDate)
            listElement.appendChild(listDiv)
            listDate.setAttribute('class', 'date')
            i++
            listElement.setAttribute('class', `week-table-container c${i}`)
            document.getElementById('weekT').append(listElement)
        });
    
        const listDate = document.createElement('h2')
        listDate.innerText='Simulcasts on our database'
        listDate.setAttribute('class', 'title')
        document.getElementById('weekT').prepend(listDate)

        document.getElementsByClassName('payment')[0].style.webkitAnimationPlayState = "running";
        document.getElementsByClassName('week-table')[0].style.webkitAnimationPlayState = "running";
    })
}

setInterval(() => {
    retrieveData()
}, 60000);
</script>
</body>
</html>